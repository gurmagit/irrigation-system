<div class="device-list">
  <mat-toolbar>
    <span>Device List</span>
    <span class="spacer"></span>
    <button mat-flat-button color="accent"  (click)="addDevice()">Add Device
      <mat-icon>add</mat-icon>
    </button>
  </mat-toolbar>
  <table mat-table [dataSource]="devices" class="mat-elevation-z8">
    <ng-container matColumnDef="name">
      <th mat-header-cell *matHeaderCellDef> Name </th>
      <td mat-cell *matCellDef="let device"> {{device.name}} </td>
    </ng-container>
    <ng-container matColumnDef="status">
      <th mat-header-cell *matHeaderCellDef> Status </th>
      <td mat-cell *matCellDef="let device">
        <button mat-icon-button class="valve-button" (click)="toggleDeviceStatus(device)">
          <div [ngClass]="{'valve-open': device.status === 'open', 'valve-closed': device.status === 'close'}">
            <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" class="valve-icon">
              <circle cx="50" cy="50" r="40" stroke="black" stroke-width="5" [attr.fill]="device.status === 'open' ? '#32CD32' : '#FF6347'" />
              <rect id="valveHandle" x="45" y="10" width="10" height="40" fill="black" />
            </svg>
          </div>
        </button>
      </td>
    </ng-container>
    <ng-container matColumnDef="schedules">
      <th mat-header-cell *matHeaderCellDef> Schedules </th>
      <td mat-cell *matCellDef="let device">
        <ul>
          <li *ngFor="let schedule of device.schedules">
            {{ schedule.startTime }} - {{ schedule.endTime }} ({{ schedule.days.join(', ') }})
          </li>
        </ul>
      </td>
    </ng-container>
    <ng-container matColumnDef="action">
      <th mat-header-cell *matHeaderCellDef> Actions </th>
      <td mat-cell *matCellDef="let device">
        <button mat-button (click)="editDevice(device)">Edit</button>
        <button mat-button (click)="deleteDevice(device.name)">Delete</button>
      </td>
    </ng-container>
    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>
</div>
